<<<<<<< HEAD
#LyrOrdata<-readr::read_csv("/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/BehaviouralResults/LyrOrScores.csv")
meansync$lyror<-LyrOrdata$LyrOr
print("2x4 ANOVA with Lyric Orientation covariate")
mod.full <- lm(corr~lyror + stim*ses, data=meansync)
mod.rest <- lm(corr~lyror ,data=meansync)
a2 <- anova(mod.full, mod.rest)
print(a2)
pval<-c(pval,a2$'Pr(>F)'[2])
a3 <- anova(mod.full)
print(a3)
a=summary(a3)[1,5]
pval<-c(pval,a)
a=summary(a3)[2,5]
pval<-c(pval,a)
a=summary(a3)[3,5]
pval<-c(pval,a)
a=summary(a3)[4,5]
pval<-c(pval,a)
sink()
write.csv(pval,file=sprintf("/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Data/%s_pval_ANOVAs.csv",str_replace(files[f],".csv","")))
=======
<<<<<<< HEAD
anova(fit)
print(summary(fit))
# test the effect of Grazing, when the covariate is included
mF <- lm(Fruit ~ Grazing + Root, data=compensation)
mR <- lm(Fruit ~ Root, data=compensation)
anova(mR, mF)
anova(mF)
# test the effect of Grazing, when the covariate is included
mF <- lm(Fruit ~ Grazing + Root, data=compensation)
mR <- lm(Fruit ~ Root, data=compensation)
anova(mR, mF)
# we can test whether a covariate should be included
mCovF <- lm(Fruit ~ Grazing + Root, data=compensation)
mCovR <- lm(Fruit ~ Grazing, data=compensation)
anova(mCovR, mCovF)
data<-read.csv(fullfiles[f], header=FALSE) #load data
data<-rename(data,c("V1"="1_song1", "V2"="1_song2", "V3"="1_song3", "V4"="1_song4",
"V5"="1_song5", "V6"="1_song6", "V7"="1_song7", "V8"="1_song8",
"V9"="2_song1", "V10"="2_song2", "V11"="2_song3", "V12"="2_song4",
"V13"="2_song5", "V14"="2_song6", "V15"="2_song7", "V16"="2_song8"))
# sum-to-zero convention for contrast weights
options(contrasts=c("contr.sum","contr.poly"))
# load in data file
fname <- "http://www.gribblelab.org/stats2019/data/2waydata.csv"
mydata <- read.table(fname, sep=",", header=T, stringsAsFactors=T)
myanova <- aov(DV~factorA*factorB,data=mydata)
summary(myanova)
mydata
View(mydata)
myanova <- aov(DV~factorA*factorB,data=mydata)
summary(myanova)
l=dim(meansync2)[1]
ses<-c(rep(1,l),rep(2,l))
stim<-c(rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4),rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4))
meansync$ses<-ses
meansync$stim<-stim
#fit<-aov(corr~stim + ses +stim:ses,data=meansync)
fit<-aov(corr~stim*ses,data=meansync)
print(summary(fit))
# table of means
with(mydata, tapply(DV,list(factorA,factorB),mean))
# plot means
with(mydata, interaction.plot(factorA,factorB,DV,col=2:3,lty=1))
# Tukey tests of individual differences
TukeyHSD(myanova, "factorA:factorB")
with(meansync, tapply(corr,list(ses,stim),mean))
# plot means
with(mydata, interaction.plot(ses,stim,corr,col=2:3,lty=1))
# plot means
with(meansync, interaction.plot(ses,stim,corr,col=2:3,lty=1))
# test B1A1 vs B1A2
SSpsi = (5 * (3.0 - 4.2)**2) / ((+1)**2 + (-1)**2)
Fpsi = (SSpsi/1) / 0.750
p_psi = pf(Fpsi, 1, 24, lower.tail=FALSE) # uncorrected
# illustration:
summary(aov(DV~factorA,data=mydata))
summary(aov(DV~factorB,data=mydata))
summary(aov(DV~factorA+factorB,data=mydata))
summary(aov(DV~factorA+factorB+factorA:factorB,data=mydata))
summary(aov(DV~factorA*factorB, data=mydata))
# plot means
with(meansync, interaction.plot(ses,stim,corr))
# plot means
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1))
#MAC
fullfiles<-grep(list.files(path = "/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/fMRI analysis/SynchronyStats/Data",
pattern="*.csv", full.names = TRUE), pattern='pval',inv=T, value=T)
files<-grep(list.files(path="/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/fMRI analysis/SynchronyStats/Data",
pattern="*.csv", full.names = FALSE), pattern='pval', inv=T, value=T)
files
f<-65
pval<-c()
=======
t<-data$OOO
regfuncmus(s,t)
t<-data$SP
regfuncmus(s,t)
t<-data$R
regfuncmus(s,t)
t<-data$FM
regfuncmus(s,t)
t<-data$P
regfuncmus(s,t)
t<-data$SS
regfuncmus(s,t)
t<-data$PA
regfuncmus(s,t)
t<-data$TS
regfuncmus(s,t)
t<-data$ML
regfuncmus(s,t)
s<-A2
t<-data$DS
regfuncmus(s,t)
t<-data$Gr
regfuncmus(s,t)
t<-data$GR
regfuncmus(s,t)
t<-data$DT
regfuncmus(s,t)
t<-data$OOO
regfuncmus(s,t)
t<-data$SP
regfuncmus(s,t)
t<-data$R
regfuncmus(s,t)
t<-data$FM
regfuncmus(s,t)
t<-data$P
regfuncmus(s,t)
t<-data$SS
regfuncmus(s,t)
t<-data$PA
regfuncmus(s,t)
t<-data$TS
regfuncmus(s,t)
t<-data$ML
regfuncmus(s,t)
t<-data$DS
s<-I2
t<-data$DS
regfuncmus(s,t)
t<-data$GR
regfuncmus(s,t)
t<-data$DT
regfuncmus(s,t)
t<-data$OOO
regfuncmus(s,t)
t<-data$SP
regfuncmus(s,t)
t<-data$R
regfuncmus(s,t)
t<-data$FM
regfuncmus(s,t)
t<-data$P
regfuncmus(s,t)
t<-data$SS
regfuncmus(s,t)
t<-data$PA
regfuncmus(s,t)
t<-data$TS
regfuncmus(s,t)
t<-data$ML
regfuncmus(s,t)
s<-S2
t<-data$DS
regfuncmus(s,t)
t<-data$GR
regfuncmus(s,t)
t<-data$DT
regfuncmus(s,t)
t<-data$OOO
regfuncmus(s,t)
t<-data$SP
regfuncmus(s,t)
t<-data$R
regfuncmus(s,t)
t<-data$FM
regfuncmus(s,t)
t<-data$P
regfuncmus(s,t)
t<-data$SS
regfuncmus(s,t)
t<-data$PA
regfuncmus(s,t)
t<-data$TS
regfuncmus(s,t)
t<-data$ML
regfuncmus(s,t)
s<-W2
t<-data$DS
regfuncmus(s,t)
t<-data$GR
regfuncmus(s,t)
t<-data$DT
regfuncmus(s,t)
t<-data$OOO
regfuncmus(s,t)
t<-data$SP
regfuncmus(s,t)
t<-data$R
regfuncmus(s,t)
t<-data$FM
regfuncmus(s,t)
t<-data$P
regfuncmus(s,t)
s<-W2
t<-data$P
regfuncmus(s,t)
t<-data$SS
regfuncmus(s,t)
t<-data$PA
regfuncmus(s,t)
t<-data$TS
regfuncmus(s,t)
t<-data$ML
regfuncmus(s,t)
>>>>>>> e2c8c9011f89314d74ddf205ff7def0214dc038f
library(tidyverse)
library(ggplot2)
library(plyr)
library(gridExtra)
#fullfiles<-list.files(path = "Data", pattern="*.csv",full.names = TRUE)
#files<-list.files(path = "Data", pattern="*.csv",full.names = FALSE)
#fullfiles<-list.files(path = "Data", pattern="*_L_",full.names = TRUE)
#files<-list.files(path = "Data", pattern="_L_",full.names = FALSE)
#WINDOWS
fullfiles<-grep(list.files(path = "/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Data",
pattern="*.csv", full.names = TRUE), pattern='pval',inv=T, value=T)
files<-grep(list.files(path="/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Data",
pattern="*.csv", full.names = FALSE), pattern='pval', inv=T, value=T)
#MAC
#fullfiles<-grep(list.files(path = "/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/fMRI analysis/SynchronyStats/Data",
#                           pattern="*.csv", full.names = TRUE), pattern='pval',inv=T, value=T)
#files<-grep(list.files(path="/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/fMRI analysis/SynchronyStats/Data",
#                       pattern="*.csv", full.names = FALSE), pattern='pval', inv=T, value=T)
<<<<<<< HEAD
for(f in 1:length(fullfiles)){
#f<- 66 #frontal_L_4 IFG opercularis
pval<-c()
=======
f<- 66 #frontal_L_4 IFG opercularis
>>>>>>> 85c138c9b70f19126c222b60092362713f32f37e
>>>>>>> e2c8c9011f89314d74ddf205ff7def0214dc038f
data<-read.csv(fullfiles[f], header=FALSE) #load data
data<-rename(data,c("V1"="1_song1", "V2"="1_song2", "V3"="1_song3", "V4"="1_song4",
"V5"="1_song5", "V6"="1_song6", "V7"="1_song7", "V8"="1_song8",
"V9"="2_song1", "V10"="2_song2", "V11"="2_song3", "V12"="2_song4",
"V13"="2_song5", "V14"="2_song6", "V15"="2_song7", "V16"="2_song8"))
GroupAdata<-data[c(1,3,5,7,10,12,13,14,16,18),c(1:16)]
GroupBdata<-data[c(2,4,6,8,9,11,15,17,19),c(1:16)]
#synchrony<-data %>% gather(songs, corr) #rearrange data
##### RUN ALL STATS #####
## Gather all session 1 data
A1<-rowMeans(select(data, "1_song1","1_song8")) #ses 1 acapella data together
I1<-rowMeans(select(data, "1_song6","1_song7")) #ses 1 instrumental data together
S1<-rowMeans(select(data, "1_song2","1_song3")) #ses 1 spoken data together
W1<-rowMeans(select(data, "1_song4",'1_song5'))  #ses 1 whole data together
<<<<<<< HEAD
meansync1<-data.frame(A1,I1,S1,W1)
meansync1<-meansync1 %>% gather(type, corr) #rearrange data
## Gather all session 2 data
A2<-rowMeans(select(data, "2_song1","2_song8")) #ses 1 acapella data together
I2<-rowMeans(select(data, "2_song6","2_song7")) #ses 1 instrumental data together
S2<-rowMeans(select(data, "2_song2","2_song3")) #ses 1 spoken data together
W2<-rowMeans(select(data, "2_song4",'2_song5'))  #ses 1 whole data together
meansync2<-data.frame(A2,I2,S2,W2)
meansync2<-meansync2 %>% gather(type, corr) #rearrange data
meansync<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
meansync<-meansync %>% gather(type, corr) #rearrange data
## Gather all data across sessions together
A<-rowMeans(select(data, "1_song1","1_song8","2_song1","2_song8"))
I<-rowMeans(select(data, "1_song6","1_song7","2_song6","2_song7"))
S<-rowMeans(select(data, "1_song2","1_song3","2_song2","2_song3"))
W<-rowMeans(select(data, "1_song4","1_song5","2_song4","2_song5"))
meansyncALL<-data.frame(A,I,S,W)
meansyncALL<-meansyncALL %>% gather(type, corr) #rearrange data
fit<-aov(corr~type,data=meansync1)
print(summary(fit))
fit<-aov(corr~type,data=meansync2)
print(summary(fit))
fit<-aov(corr~type,data=meansyncALL)
print(summary(fit))
View(meansync)
l=dim(meansync2)[1]
ses<-c(rep(1,l),rep(2,l))
stim<-c(rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4),rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4))
meansync$ses<-ses
meansync$stim<-stim
#fit<-aov(corr~stim + ses +stim:ses,data=meansync)
fit<-aov(corr~stim*ses,data=meansync)
print(summary(fit))
# table of means
with(meansync, tapply(corr,list(ses,stim),mean))
# plot means
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1))
meansync<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
meansync<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
meansync<-meansync %>% gather(type, corr) #rearrange data
meansync<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
View(meansync)
View(meansync)
meansync<-meansync %>% gather(type, corr) #rearrange data
l=dim(meansync2)[1]
ses<-c(rep(1,l),rep(2,l))
stim<-c(rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4),rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4))
meansync<-meansync[,-1]
meansync<-meansync %>% gather(type, corr) #rearrange data
meansync<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
meansync<-meansync %>% gather(type, corr) #rearrange data
l=dim(meansync2)[1]
ses<-c(rep(1,l),rep(2,l))
stim<-c(rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4),rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4))
meansync$ses<-ses
meansync$stim<-stim
View(meansync)
meansync<-meansync[,-type]
meansync<-meansync[,-1]
meansyncALL2<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
meansyncALL2<-meansyncALL2 %>% gather(type, corr) #rearrange data
l=dim(meansync2)[1]
stim<-c(rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4),rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4))
meansyncALL2$stim<-stim
View(meansyncALL2)
View(meansyncALL2)
meansyncALL2<-meansyncALL2[,-1]
fit<-aov(corr~type,data=meansyncALL)
print(summary(fit))
fit<-aov(corr~stim,data=meansyncALL2)
print(summary(fit))
# plot means
plot(type, data=meansyncALL)
View(meansyncALL)
# plot means
plot(corr, data=meansyncALL)
# plot means
plot(meansynchALL$corr, data=meansyncALL)
# plot means
plot(meansyncALL$corr, data=meansyncALL)
p<-ggplot(meansyncALL) + aes(x=type,y=corr) + geom_line()
warnings()
p<-ggplot(meansyncALL) + aes(x=type,y=corr) +
p<-ggplot(meansyncALL) + aes(x=type,y=corr) +
geom_boxplot(color=c("red","red","blue","blue","green","green","black","black")) +
geom_hline(yintercept=0,size=1)
p<-ggplot(meansyncALL) +
aes(x=type,y=corr) +
geom_boxplot(color=c("red","red","blue","blue","green","green","black","black"))
print("Session 1&2 ANOVA - TYPE 2")
p<-(ggplot(meansyncALL) +
p<-(ggplot(meansyncALL) +
aes(x=type,y=corr) +
geom_boxplot(color=c("red","red","blue","blue","green","green","black","black")))
ggplot(meansyncALL) +
aes(x=type,y=corr) +
geom_boxplot(color=c("red","red","blue","blue","green","green","black","black"))
ggplot(meansyncALL) +
aes(x=type,y=corr) +
geom_boxplot()
ggplot(meansyncALL2) + aes(x=type,y=corr) + geom_boxplot()
ggplot(meansyncALL2) + aes(x=stim,y=corr) + geom_boxplot()
ggplot(meansyncALL2) + aes(x=as.factor(stim),y=corr) + geom_boxplot()
ggplot(meansyncALL) + aes(x=type,y=corr) + geom_boxplot()
ggplot(meansyncALL) + aes(x=type,y=corr) + geom_boxplot() + ylim(-0.3,0.3)
ggplot(meansyncALL2) + aes(x=as.factor(stim),y=corr) + geom_boxplot() + ylim(-0.3,0.3)
p1<-ggplot(meansyncALL) + aes(x=type,y=corr) + geom_boxplot() + ylim(-0.3,0.3)
p2<-ggplot(meansyncALL2) + aes(x=as.factor(stim),y=corr) + geom_boxplot() + ylim(-0.3,0.3)
grid.arrange(p1, p2, nrow = 1)
library(gridExtra)
grid.arrange(p1, p2, nrow = 1)
p1<-ggplot(meansyncALL) + aes(x=type,y=corr) + geom_boxplot() +
ylim(-0.3,0.3) + ggtitle('Data Averaged First')
p2<-ggplot(meansyncALL2) + aes(x=as.factor(stim),y=corr) + geom_boxplot() +
ylim(-0.3,0.3) + ggtitle('Data NOT Averaged First')
grid.arrange(p1, p2, nrow = 1)
# plot means
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1))
fit<-aov(corr~type,data=meansyncALL)
print(summary(fit))
fit<-aov(corr~stim,data=meansyncALL2)
print(summary(fit))
p1<-ggplot(meansyncALL) + aes(x=type,y=corr) + geom_boxplot() +
ylim(-0.3,0.3) + ggtitle('Data Averaged First - sig')
p2<-ggplot(meansyncALL2) + aes(x=as.factor(stim),y=corr) + geom_boxplot() +
ylim(-0.3,0.3) + ggtitle('Data NOT Averaged First - not sig')
grid.arrange(p1, p2, nrow = 1)
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1))
fit<-aov(corr~stim*ses,data=meansync)
print(summary(fit))
=======
## Gather all session 2 data
A2<-rowMeans(select(data, "2_song1","2_song8")) #ses 1 acapella data together
I2<-rowMeans(select(data, "2_song6","2_song7")) #ses 1 instrumental data together
S2<-rowMeans(select(data, "2_song2","2_song3")) #ses 1 spoken data together
W2<-rowMeans(select(data, "2_song4",'2_song5'))  #ses 1 whole data together
## Gather all data ignoring sessions
A<-rowMeans(select(data, "1_song1","1_song8","2_song1","2_song8"))
I<-rowMeans(select(data, "1_song6","1_song7","2_song6","2_song7"))
S<-rowMeans(select(data, "1_song2","1_song3","2_song2","2_song3"))
W<-rowMeans(select(data, "1_song4","1_song5","2_song4","2_song5"))
## OTHER STUFF
l=dim(meansync2)[1]
ses<-c(rep(1,l),rep(2,l))
stim<-c(rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4),rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4))
## Stats
##### START PRINTING RESULTS TO TEXT FILE #####
sink(file=sprintf("/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Data/%s_ANOVAs.txt",str_replace(files[f],".csv","")))
files[f]
#2x4 ANOVA
print("ANOVA - 2(ses) x 4(stim)")
meansync<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
meansync<-meansync %>% gather(type, corr) #rearrange data
meansync$ses<-ses
meansync$stim<-stim
fit1<-aov(corr~stim + ses +stim:ses,data=meansync)
print(summary(fit1))
a=summary(fit1)[[1]][["Pr(>F)"]][[1]]
pval<-c(pval,a)
#plot
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1,main="main effect of session"))
p<-ggplot(meansync) +
aes(x=type,y=corr) +
geom_boxplot(color=c("red","blue","green","black","red","blue","green","black")) +
geom_hline(yintercept=0,size=1)+
facet_wrap(~ses)
plot(p)
print("Session 1 ANOVA")
meansync1<-data.frame(A1,I1,S1,W1)
meansync1<-meansync1 %>% gather(type, corr) #rearrange data
fit2<-aov(corr~type,data=meansync1)
print(summary(fit2))
a=summary(fit2)[[1]][["Pr(>F)"]][[1]]
pval<-c(pval,a)
print("Session 2 ANOVA")
meansync2<-data.frame(A2,I2,S2,W2)
meansync2<-meansync2 %>% gather(type, corr) #rearrange data
fit3<-aov(corr~type,data=meansync2)
print(summary(fit3))
a=summary(fit3)[[1]][["Pr(>F)"]][[1]]
pval<-c(pval,a)
print("Session 1&2 ANOVA - TYPE 1 - DATA AVERAGED FIRST")
meansyncALL<-data.frame(A,I,S,W)
meansyncALL<-meansyncALL %>% gather(type, corr) #rearrange data
fit4<-aov(corr~type,data=meansyncALL)
print(summary(fit4))
a=summary(fit4)[[1]][["Pr(>F)"]][[1]]
pval<-c(pval,a)
p1<-ggplot(meansyncALL) + aes(x=type,y=corr) + geom_boxplot() +
ylim(-0.3,0.3) + ggtitle('Data Averaged First - sig')
# print("Session 1&2 ANOVA - TYPE 2 - DATA NOT AVERAGED FIRST")
# meansyncALL2<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
# meansyncALL2<-meansyncALL2 %>% gather(type, corr) #rearrange data
# meansyncALL2$stim<-stim
# fit<-aov(corr~stim,data=meansyncALL2)
# print(summary(fit))
# p2<-ggplot(meansyncALL2) + aes(x=as.factor(stim),y=corr) + geom_boxplot() +
#   ylim(-0.3,0.3) + ggtitle('Data NOT Averaged First - not sig')
# plot means
# grid.arrange(p1, p2, nrow = 1)
# 2x4 ANOVA with LyrOr Covariate
LyrOrdata<-readr::read_csv("/Users/asternin/Documents/PhDProject/Music and Memory/BehaviouralResults/LyrOrScores.csv")
#LyrOrdata<-readr::read_csv("/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/BehaviouralResults/LyrOrScores.csv")
meansync$lyror<-LyrOrdata$LyrOr
print("2x4 ANOVA with Lyric Orientation covariate")
mod.full <- lm(corr~lyror + stim*ses, data=meansync)
mod.rest <- lm(corr~lyror ,data=meansync)
a2 <- anova(mod.full, mod.rest)
print(a2)
pval<-c(pval,a2$'Pr(>F)'[2])
a3 <- anova(mod.full)
print(a3)
a=summary(a3)[1,5]
pval<-c(pval,a)
a=summary(a3)[2,5]
pval<-c(pval,a)
a=summary(a3)[3,5]
pval<-c(pval,a)
a=summary(a3)[4,5]
pval<-c(pval,a)
sink()
write.csv(pval,file=sprintf("/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Data/%s_pval_ANOVAs.csv",str_replace(files[f],".csv","")))
}
#CORRECT P VALS FOR MULTIPLE COMPARISONS - FDR
fullfiles<-list.files(path = "/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Data",
pattern="*_pval_ANOVAs.csv",full.names = TRUE)
files<-list.files(path = "/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Data",
pattern="*_pval_ANOVAs.csv",full.names = FALSE)
library(tidyverse)
library(ggplot2)
library(plyr)
#CORRECT P VALS FOR MULTIPLE COMPARISONS - FDR
fullfiles<-list.files(path = "/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Data",
pattern="*_pval_ANOVAs.csv",full.names = TRUE)
files<-list.files(path = "/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Data",
pattern="*_pval_ANOVAs.csv",full.names = FALSE)
for(f in 1:length(fullfiles)){
data<-read.csv(fullfiles[f], header=TRUE) #load data
data<-rename(data,c("X"="test", "x"="pval"))
p=data$pval
p_adj<-p.adjust(p,method="fdr",n=length(p))
write.csv(p_adj,file=sprintf("/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Data/%s_adj.csv",str_replace(files[f],".csv","")))
}
#EXTRACT SIG P VALS AFTER FDR CORRECTION
fullfiles<-list.files(path = "/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Data",
pattern="*_pval_ANOVAs_adj.csv",full.names = TRUE)
files<-list.files(path = "/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Data",
pattern="*_pval_ANOVAs_adj.csv",full.names = FALSE)
sink(file=sprintf("/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/SummaryDocs/AdjPVal_ANOVAs_Summary.txt"))
for(f in 1:length(fullfiles)){
tests<-c()
data<-read.csv(fullfiles[f], header=TRUE) #load data
data<-rename(data,c("X"="test", "x"="pval"))
for(p in 1:length(data$test)){
if(data$pval[p] < 0.06)
tests<-c(tests,data$test[p])
}
print(files[f])
print(tests)
}
sink()
files
#WINDOWS
fullfiles<-grep(list.files(path = "/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Data",
pattern="*.csv", full.names = TRUE), pattern='pval',inv=T, value=T)
files<-grep(list.files(path="/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Data",
pattern="*.csv", full.names = FALSE), pattern='pval', inv=T, value=T)
files
f<-3
pval<-c()
data<-read.csv(fullfiles[f], header=FALSE) #load data
data<-rename(data,c("V1"="1_song1", "V2"="1_song2", "V3"="1_song3", "V4"="1_song4",
"V5"="1_song5", "V6"="1_song6", "V7"="1_song7", "V8"="1_song8",
"V9"="2_song1", "V10"="2_song2", "V11"="2_song3", "V12"="2_song4",
"V13"="2_song5", "V14"="2_song6", "V15"="2_song7", "V16"="2_song8"))
GroupAdata<-data[c(1,3,5,7,10,12,13,14,16,18),c(1:16)]
GroupBdata<-data[c(2,4,6,8,9,11,15,17,19),c(1:16)]
#synchrony<-data %>% gather(songs, corr) #rearrange data
##### RUN ALL STATS #####
## Gather all session 1 data
A1<-rowMeans(select(data, "1_song1","1_song8")) #ses 1 acapella data together
I1<-rowMeans(select(data, "1_song6","1_song7")) #ses 1 instrumental data together
S1<-rowMeans(select(data, "1_song2","1_song3")) #ses 1 spoken data together
W1<-rowMeans(select(data, "1_song4",'1_song5'))  #ses 1 whole data together
## Gather all session 2 data
A2<-rowMeans(select(data, "2_song1","2_song8")) #ses 1 acapella data together
I2<-rowMeans(select(data, "2_song6","2_song7")) #ses 1 instrumental data together
S2<-rowMeans(select(data, "2_song2","2_song3")) #ses 1 spoken data together
W2<-rowMeans(select(data, "2_song4",'2_song5'))  #ses 1 whole data together
## Gather all data ignoring sessions
A<-rowMeans(select(data, "1_song1","1_song8","2_song1","2_song8"))
I<-rowMeans(select(data, "1_song6","1_song7","2_song6","2_song7"))
S<-rowMeans(select(data, "1_song2","1_song3","2_song2","2_song3"))
W<-rowMeans(select(data, "1_song4","1_song5","2_song4","2_song5"))
## OTHER STUFF
l=dim(meansync2)[1]
ses<-c(rep(1,l),rep(2,l))
stim<-c(rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4),rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4))
<<<<<<< HEAD
# 2x4 ANOVA with LyrOr Covariate
LyrOrdata<-readr::read_csv("/Users/asternin/Documents/PhDProject/Music and Memory/BehaviouralResults/LyrOrScores.csv")
#LyrOrdata<-readr::read_csv("/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/BehaviouralResults/LyrOrScores.csv")
meansync$lyror<-LyrOrdata$LyrOr
print("2x4 ANOVA with Lyric Orientation covariate")
mod.full <- lm(corr~lyror + stim*ses, data=meansync)
mod.rest <- lm(corr~lyror ,data=meansync)
a2 <- anova(mod.full, mod.rest)
print(a2)
files[3]
library(tidyverse)
library(ggplot2)
library(plyr)
library(gridExtra)
#fullfiles<-list.files(path = "Data", pattern="*.csv",full.names = TRUE)
#files<-list.files(path = "Data", pattern="*.csv",full.names = FALSE)
#fullfiles<-list.files(path = "Data", pattern="*_L_",full.names = TRUE)
#files<-list.files(path = "Data", pattern="_L_",full.names = FALSE)
#WINDOWS
fullfiles<-grep(list.files(path = "/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Data",
pattern="*.csv", full.names = TRUE), pattern='pval',inv=T, value=T)
files<-grep(list.files(path="/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Data",
pattern="*.csv", full.names = FALSE), pattern='pval', inv=T, value=T)
#MAC
#fullfiles<-grep(list.files(path = "/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/fMRI analysis/SynchronyStats/Data",
#                           pattern="*.csv", full.names = TRUE), pattern='pval',inv=T, value=T)
#files<-grep(list.files(path="/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/fMRI analysis/SynchronyStats/Data",
#                       pattern="*.csv", full.names = FALSE), pattern='pval', inv=T, value=T)
for(f in 1:length(fullfiles)){
#f<- 66 #frontal_L_4 IFG opercularis
pval<-c()
=======
meansync<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
meansync<-meansync %>% gather(type, corr) #rearrange data
meansync$ses<-ses
meansync$stim<-stim
fit<-aov(corr~stim + ses +stim:ses,data=meansync)
print(summary(fit))
# plot means
grid.arrange(p1, p2, nrow = 1)
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1,main="main effect of session"))
meansyncALL2<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
meansyncALL2<-meansyncALL2 %>% gather(type, corr) #rearrange data
meansyncALL2$stim<-stim
fit<-aov(corr~stim,data=meansyncALL2)
print(summary(fit))
p2<-ggplot(meansyncALL2) + aes(x=as.factor(stim),y=corr) + geom_boxplot() +
ylim(-0.3,0.3) + ggtitle('Data NOT Averaged First - not sig')
# plot means
grid.arrange(p1, p2, nrow = 1)
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1,main="main effect of session"))
>>>>>>> 85c138c9b70f19126c222b60092362713f32f37e
meansync<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
meansync<-meansync %>% gather(type, corr) #rearrange data
meansync$ses<-ses
meansync$stim<-stim
<<<<<<< HEAD
fit<-aov(corr~stim*ses,data=meansync)
print(summary(fit))
files
f<- 65 #frontal_L_4 IFG opercularis
=======
fit<-aov(corr~stim + ses +stim:ses,data=meansync)
print(summary(fit))
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1,main="main effect of session"))
fit<-aov(corr~type,data=meansync1)
print(summary(fit))
fit<-aov(corr~type,data=meansyncALL)
print(summary(fit))
files
files[2]
files[8]
f<-8
>>>>>>> 85c138c9b70f19126c222b60092362713f32f37e
>>>>>>> e2c8c9011f89314d74ddf205ff7def0214dc038f
data<-read.csv(fullfiles[f], header=FALSE) #load data
data<-rename(data,c("V1"="1_song1", "V2"="1_song2", "V3"="1_song3", "V4"="1_song4",
"V5"="1_song5", "V6"="1_song6", "V7"="1_song7", "V8"="1_song8",
"V9"="2_song1", "V10"="2_song2", "V11"="2_song3", "V12"="2_song4",
"V13"="2_song5", "V14"="2_song6", "V15"="2_song7", "V16"="2_song8"))
GroupAdata<-data[c(1,3,5,7,10,12,13,14,16,18),c(1:16)]
GroupBdata<-data[c(2,4,6,8,9,11,15,17,19),c(1:16)]
<<<<<<< HEAD
#synchrony<-data %>% gather(songs, corr) #rearrange data
##### RUN ALL STATS #####
## Gather all session 1 data
=======
<<<<<<< HEAD
##### RUN ALL STATS #####
## Gather all session 1 data
=======
>>>>>>> 85c138c9b70f19126c222b60092362713f32f37e
>>>>>>> e2c8c9011f89314d74ddf205ff7def0214dc038f
A1<-rowMeans(select(data, "1_song1","1_song8")) #ses 1 acapella data together
I1<-rowMeans(select(data, "1_song6","1_song7")) #ses 1 instrumental data together
S1<-rowMeans(select(data, "1_song2","1_song3")) #ses 1 spoken data together
W1<-rowMeans(select(data, "1_song4",'1_song5'))  #ses 1 whole data together
## Gather all session 2 data
A2<-rowMeans(select(data, "2_song1","2_song8")) #ses 1 acapella data together
I2<-rowMeans(select(data, "2_song6","2_song7")) #ses 1 instrumental data together
S2<-rowMeans(select(data, "2_song2","2_song3")) #ses 1 spoken data together
W2<-rowMeans(select(data, "2_song4",'2_song5'))  #ses 1 whole data together
## Gather all data ignoring sessions
A<-rowMeans(select(data, "1_song1","1_song8","2_song1","2_song8"))
I<-rowMeans(select(data, "1_song6","1_song7","2_song6","2_song7"))
S<-rowMeans(select(data, "1_song2","1_song3","2_song2","2_song3"))
W<-rowMeans(select(data, "1_song4","1_song5","2_song4","2_song5"))
## OTHER STUFF
l=dim(meansync2)[1]
ses<-c(rep(1,l),rep(2,l))
stim<-c(rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4),rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4))
<<<<<<< HEAD
## Stats
##### START PRINTING RESULTS TO TEXT FILE #####
sink(file=sprintf("/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Data/%s_ANOVAs.txt",str_replace(files[f],".csv","")))
files[f]
=======
<<<<<<< HEAD
print("Session 1 ANOVA")
=======
>>>>>>> e2c8c9011f89314d74ddf205ff7def0214dc038f
#2x4 ANOVA
print("ANOVA - 2(ses) x 4(stim)")
meansync<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
meansync<-meansync %>% gather(type, corr) #rearrange data
meansync$ses<-ses
meansync$stim<-stim
<<<<<<< HEAD
fit1<-aov(corr~stim + ses +stim:ses,data=meansync)
print(summary(fit1))
a=summary(fit1)[[1]][["Pr(>F)"]][[1]]
pval<-c(pval,a)
=======
fit<-aov(corr~stim + ses +stim:ses,data=meansync)
print(summary(fit))
#plot
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1,main="main effect of session"))
>>>>>>> 85c138c9b70f19126c222b60092362713f32f37e
meansync1<-data.frame(A1,I1,S1,W1)
meansync1<-meansync1 %>% gather(type, corr) #rearrange data
fit<-aov(corr~type,data=meansync1)
print(summary(fit))
print("Session 2 ANOVA")
meansync2<-data.frame(A2,I2,S2,W2)
meansync2<-meansync2 %>% gather(type, corr) #rearrange data
fit<-aov(corr~type,data=meansync2)
print(summary(fit))
<<<<<<< HEAD
print("Session 1&2 ANOVA - TYPE 1 - DATA AVERAGED FIRST")
meansyncALL<-data.frame(A,I,S,W)
meansyncALL<-meansyncALL %>% gather(type, corr) #rearrange data
fit<-aov(corr~type,data=meansyncALL)
print(summary(fit))
p1<-ggplot(meansyncALL) + aes(x=type,y=corr) + geom_boxplot() +
ylim(-0.3,0.3) + ggtitle('Data Averaged First - sig')
print("Session 1&2 ANOVA - TYPE 2 - DATA NOT AVERAGED FIRST")
#2x4 ANOVA
print("ANOVA - 2(ses) x 4(stim)")
=======
gp <- ggplot(data=meansync, aes(x=ses, y=stim, colour=factor(up)))
gp + geom_point() + stat_smooth(method="lm")
gp <- ggplot(data=meansync, aes(x=ses, y=stim))
gp + geom_point() + stat_smooth(method="lm")
>>>>>>> e2c8c9011f89314d74ddf205ff7def0214dc038f
#plot
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1,main="main effect of session"))
p<-ggplot(meansync) +
aes(x=type,y=corr) +
geom_boxplot(color=c("red","blue","green","black","red","blue","green","black")) +
geom_hline(yintercept=0,size=1)+
facet_wrap(~ses)
plot(p)
<<<<<<< HEAD
print("Session 1 ANOVA")
meansync1<-data.frame(A1,I1,S1,W1)
meansync1<-meansync1 %>% gather(type, corr) #rearrange data
fit2<-aov(corr~type,data=meansync1)
print(summary(fit2))
a=summary(fit2)[[1]][["Pr(>F)"]][[1]]
pval<-c(pval,a)
print("Session 2 ANOVA")
meansync2<-data.frame(A2,I2,S2,W2)
meansync2<-meansync2 %>% gather(type, corr) #rearrange data
fit3<-aov(corr~type,data=meansync2)
print(summary(fit3))
a=summary(fit3)[[1]][["Pr(>F)"]][[1]]
pval<-c(pval,a)
print("Session 1&2 ANOVA - TYPE 1 - DATA AVERAGED FIRST")
meansyncALL<-data.frame(A,I,S,W)
meansyncALL<-meansyncALL %>% gather(type, corr) #rearrange data
fit4<-aov(corr~type,data=meansyncALL)
print(summary(fit4))
a=summary(fit4)[[1]][["Pr(>F)"]][[1]]
pval<-c(pval,a)
p1<-ggplot(meansyncALL) + aes(x=type,y=corr) + geom_boxplot() +
ylim(-0.3,0.3) + ggtitle('Data Averaged First - sig')
# print("Session 1&2 ANOVA - TYPE 2 - DATA NOT AVERAGED FIRST")
# meansyncALL2<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
# meansyncALL2<-meansyncALL2 %>% gather(type, corr) #rearrange data
# meansyncALL2$stim<-stim
# fit<-aov(corr~stim,data=meansyncALL2)
# print(summary(fit))
# p2<-ggplot(meansyncALL2) + aes(x=as.factor(stim),y=corr) + geom_boxplot() +
#   ylim(-0.3,0.3) + ggtitle('Data NOT Averaged First - not sig')
# plot means
# grid.arrange(p1, p2, nrow = 1)
# 2x4 ANOVA with LyrOr Covariate
LyrOrdata<-readr::read_csv("/Users/asternin/Documents/PhDProject/Music and Memory/BehaviouralResults/LyrOrScores.csv")
#LyrOrdata<-readr::read_csv("/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/BehaviouralResults/LyrOrScores.csv")
meansync$lyror<-LyrOrdata$LyrOr
print("2x4 ANOVA with Lyric Orientation covariate")
mod.full <- lm(corr~lyror + stim*ses, data=meansync)
mod.rest <- lm(corr~lyror ,data=meansync)
a2 <- anova(mod.full, mod.rest)
print(a2)
pval<-c(pval,a2$'Pr(>F)'[2])
a3 <- anova(mod.full)
print(a3)
a=summary(a3)[1,5]
pval<-c(pval,a)
a=summary(a3)[2,5]
pval<-c(pval,a)
a=summary(a3)[3,5]
pval<-c(pval,a)
a=summary(a3)[4,5]
pval<-c(pval,a)
sink()
write.csv(pval,file=sprintf("/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Data/%s_pval_ANOVAs.csv",str_replace(files[f],".csv","")))
}
files[3]
f<-3
data<-read.csv(fullfiles[f], header=FALSE) #load data
data<-rename(data,c("V1"="1_song1", "V2"="1_song2", "V3"="1_song3", "V4"="1_song4",
"V5"="1_song5", "V6"="1_song6", "V7"="1_song7", "V8"="1_song8",
"V9"="2_song1", "V10"="2_song2", "V11"="2_song3", "V12"="2_song4",
"V13"="2_song5", "V14"="2_song6", "V15"="2_song7", "V16"="2_song8"))
GroupAdata<-data[c(1,3,5,7,10,12,13,14,16,18),c(1:16)]
GroupBdata<-data[c(2,4,6,8,9,11,15,17,19),c(1:16)]
#synchrony<-data %>% gather(songs, corr) #rearrange data
##### RUN ALL STATS #####
## Gather all session 1 data
A1<-rowMeans(select(data, "1_song1","1_song8")) #ses 1 acapella data together
I1<-rowMeans(select(data, "1_song6","1_song7")) #ses 1 instrumental data together
S1<-rowMeans(select(data, "1_song2","1_song3")) #ses 1 spoken data together
W1<-rowMeans(select(data, "1_song4",'1_song5'))  #ses 1 whole data together
## Gather all session 2 data
A2<-rowMeans(select(data, "2_song1","2_song8")) #ses 1 acapella data together
I2<-rowMeans(select(data, "2_song6","2_song7")) #ses 1 instrumental data together
S2<-rowMeans(select(data, "2_song2","2_song3")) #ses 1 spoken data together
W2<-rowMeans(select(data, "2_song4",'2_song5'))  #ses 1 whole data together
## Gather all data ignoring sessions
A<-rowMeans(select(data, "1_song1","1_song8","2_song1","2_song8"))
I<-rowMeans(select(data, "1_song6","1_song7","2_song6","2_song7"))
S<-rowMeans(select(data, "1_song2","1_song3","2_song2","2_song3"))
W<-rowMeans(select(data, "1_song4","1_song5","2_song4","2_song5"))
## OTHER STUFF
l=dim(meansync2)[1]
ses<-c(rep(1,l),rep(2,l))
stim<-c(rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4),rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4))
# 2x4 ANOVA with LyrOr Covariate
LyrOrdata<-readr::read_csv("/Users/asternin/Documents/PhDProject/Music and Memory/BehaviouralResults/LyrOrScores.csv")
#LyrOrdata<-readr::read_csv("/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/BehaviouralResults/LyrOrScores.csv")
meansync$lyror<-LyrOrdata$LyrOr
print("2x4 ANOVA with Lyric Orientation covariate")
mod.full <- lm(corr~lyror + stim*ses, data=meansync)
mod.rest <- lm(corr~lyror ,data=meansync)
a2 <- anova(mod.full, mod.rest)
print(a2)
a3 <- anova(mod.full)
print(a3)
sprintf("/Users/asternin/Documents/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Data/%s_ANOVAs.txt",str_replace(files[f],".csv",""))
=======
>>>>>>> 85c138c9b70f19126c222b60092362713f32f37e
>>>>>>> e2c8c9011f89314d74ddf205ff7def0214dc038f
meansync<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
meansync<-meansync %>% gather(type, corr) #rearrange data
meansync$ses<-ses
meansync$stim<-stim
<<<<<<< HEAD
fit1<-aov(corr~stim + ses +stim:ses,data=meansync)
print(summary(fit1))
print("Session 1 ANOVA")
meansync1<-data.frame(A1,I1,S1,W1)
meansync1<-meansync1 %>% gather(type, corr) #rearrange data
fit2<-aov(corr~type,data=meansync1)
print(summary(fit2))
a=summary(fit2)[[1]][["Pr(>F)"]][[1]]
print("Session 2 ANOVA")
meansync2<-data.frame(A2,I2,S2,W2)
meansync2<-meansync2 %>% gather(type, corr) #rearrange data
fit3<-aov(corr~type,data=meansync2)
print(summary(fit3))
print("Session 1&2 ANOVA - TYPE 1 - DATA AVERAGED FIRST")
meansyncALL<-data.frame(A,I,S,W)
meansyncALL<-meansyncALL %>% gather(type, corr) #rearrange data
fit4<-aov(corr~type,data=meansyncALL)
print(summary(fit4))
a=summary(fit4)[[1]][["Pr(>F)"]][[1]]
pval<-c(pval,a)
LyrOrdata<-readr::read_csv("/Users/asternin/Documents/PhDProject/Music and Memory/BehaviouralResults/LyrOrScores.csv")
# 2x4 ANOVA with LyrOr Covariate
meansync$lyror<-LyrOrdata$LyrOr
print("2x4 ANOVA with Lyric Orientation covariate")
mod.full <- lm(corr~lyror + stim*ses, data=meansync)
mod.rest <- lm(corr~lyror ,data=meansync)
a2 <- anova(mod.full, mod.rest)
print(a2)
a3 <- anova(mod.full)
print(a3)
anova(mod.rest)
files
files[56]
f<-56
=======
<<<<<<< HEAD
fit<-aov(corr~stim*ses,data=meansync)
print(summary(fit))
fit<-aov(corr~stim + ses +stim:ses,data=meansync)
print(summary(fit))
#MAC
fullfiles<-grep(list.files(path = "/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/fMRI analysis/SynchronyStats/Data",
pattern="*.csv", full.names = TRUE), pattern='pval',inv=T, value=T)
files<-grep(list.files(path="/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/fMRI analysis/SynchronyStats/Data",
pattern="*.csv", full.names = FALSE), pattern='pval', inv=T, value=T)
f<-65
=======
fit<-aov(corr~stim + ses +stim:ses,data=meansync)
print(summary(fit))
#plot
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1,main="main effect of session"))
p<-ggplot(meansync) +
aes(x=type,y=corr) +
geom_boxplot(color=c("red","blue","green","black","red","blue","green","black")) +
geom_hline(yintercept=0,size=1) +
ylim(-0.4,0.4)+
facet_wrap(~ses)
plot(p)
files
files[2]
f<-2
>>>>>>> 85c138c9b70f19126c222b60092362713f32f37e
>>>>>>> e2c8c9011f89314d74ddf205ff7def0214dc038f
data<-read.csv(fullfiles[f], header=FALSE) #load data
data<-rename(data,c("V1"="1_song1", "V2"="1_song2", "V3"="1_song3", "V4"="1_song4",
"V5"="1_song5", "V6"="1_song6", "V7"="1_song7", "V8"="1_song8",
"V9"="2_song1", "V10"="2_song2", "V11"="2_song3", "V12"="2_song4",
"V13"="2_song5", "V14"="2_song6", "V15"="2_song7", "V16"="2_song8"))
GroupAdata<-data[c(1,3,5,7,10,12,13,14,16,18),c(1:16)]
GroupBdata<-data[c(2,4,6,8,9,11,15,17,19),c(1:16)]
<<<<<<< HEAD
=======
#synchrony<-data %>% gather(songs, corr) #rearrange data
>>>>>>> 85c138c9b70f19126c222b60092362713f32f37e
##### RUN ALL STATS #####
## Gather all session 1 data
A1<-rowMeans(select(data, "1_song1","1_song8")) #ses 1 acapella data together
I1<-rowMeans(select(data, "1_song6","1_song7")) #ses 1 instrumental data together
S1<-rowMeans(select(data, "1_song2","1_song3")) #ses 1 spoken data together
W1<-rowMeans(select(data, "1_song4",'1_song5'))  #ses 1 whole data together
<<<<<<< HEAD
meansync1<-data.frame(A1,I1,S1,W1)
meansync1<-meansync1 %>% gather(type, corr) #rearrange data
=======
>>>>>>> 85c138c9b70f19126c222b60092362713f32f37e
## Gather all session 2 data
A2<-rowMeans(select(data, "2_song1","2_song8")) #ses 1 acapella data together
I2<-rowMeans(select(data, "2_song6","2_song7")) #ses 1 instrumental data together
S2<-rowMeans(select(data, "2_song2","2_song3")) #ses 1 spoken data together
W2<-rowMeans(select(data, "2_song4",'2_song5'))  #ses 1 whole data together
<<<<<<< HEAD
meansync2<-data.frame(A2,I2,S2,W2)
meansync2<-meansync2 %>% gather(type, corr) #rearrange data
meansync<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
meansync<-meansync %>% gather(type, corr) #rearrange data
l=dim(meansync2)[1]
ses<-c(rep(1,l),rep(2,l))
stim<-c(rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4),rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4))
=======
## Gather all data ignoring sessions
A<-rowMeans(select(data, "1_song1","1_song8","2_song1","2_song8"))
I<-rowMeans(select(data, "1_song6","1_song7","2_song6","2_song7"))
S<-rowMeans(select(data, "1_song2","1_song3","2_song2","2_song3"))
W<-rowMeans(select(data, "1_song4","1_song5","2_song4","2_song5"))
## OTHER STUFF
l=dim(meansync2)[1]
ses<-c(rep(1,l),rep(2,l))
stim<-c(rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4),rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4))
<<<<<<< HEAD
# #plot
=======
## Stats
#2x4 ANOVA
print("ANOVA - 2(ses) x 4(stim)")
meansync<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
meansync<-meansync %>% gather(type, corr) #rearrange data
>>>>>>> 85c138c9b70f19126c222b60092362713f32f37e
meansync$ses<-ses
meansync$stim<-stim
fit<-aov(corr~stim + ses +stim:ses,data=meansync)
print(summary(fit))
<<<<<<< HEAD
#MAC
fullfiles<-grep(list.files(path = "/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/fMRI analysis/SynchronyStats/Data",
pattern="*.csv", full.names = TRUE), pattern='pval',inv=T, value=T)
files<-grep(list.files(path="/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/fMRI analysis/SynchronyStats/Data",
pattern="*.csv", full.names = FALSE), pattern='pval', inv=T, value=T)
files
f[65]
files[65]
files[66]
f<- 66 #frontal_L_4 IFG opercularis
=======
#plot
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1,main="main effect of session"))
p<-ggplot(meansync) +
aes(x=type,y=corr) +
geom_boxplot(color=c("red","blue","green","black","red","blue","green","black")) +
geom_hline(yintercept=0,size=1) +
ylim(-0.4,0.4)+
facet_wrap(~ses)
plot(p)
#plot
>>>>>>> e2c8c9011f89314d74ddf205ff7def0214dc038f
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1,main="main effect of session"))
source('~/PhDProject/Music and Memory/fMRI analysis/SynchronyStats/Scripts/SessionANOVAs.R', echo=TRUE)
f
<<<<<<< HEAD
f<-56
=======
p<-ggplot(meansync) +
aes(x=type,y=corr) +
geom_boxplot(color=c("red","blue","green","black","red","blue","green","black")) +
geom_hline(yintercept=0,size=1) +
ylim(-0.4,0.4)+
facet_wrap(~ses)
plot(p)
files
files[14]
f<-14
>>>>>>> 85c138c9b70f19126c222b60092362713f32f37e
>>>>>>> e2c8c9011f89314d74ddf205ff7def0214dc038f
data<-read.csv(fullfiles[f], header=FALSE) #load data
data<-rename(data,c("V1"="1_song1", "V2"="1_song2", "V3"="1_song3", "V4"="1_song4",
"V5"="1_song5", "V6"="1_song6", "V7"="1_song7", "V8"="1_song8",
"V9"="2_song1", "V10"="2_song2", "V11"="2_song3", "V12"="2_song4",
"V13"="2_song5", "V14"="2_song6", "V15"="2_song7", "V16"="2_song8"))
GroupAdata<-data[c(1,3,5,7,10,12,13,14,16,18),c(1:16)]
GroupBdata<-data[c(2,4,6,8,9,11,15,17,19),c(1:16)]
<<<<<<< HEAD
=======
#synchrony<-data %>% gather(songs, corr) #rearrange data
>>>>>>> 85c138c9b70f19126c222b60092362713f32f37e
##### RUN ALL STATS #####
## Gather all session 1 data
A1<-rowMeans(select(data, "1_song1","1_song8")) #ses 1 acapella data together
I1<-rowMeans(select(data, "1_song6","1_song7")) #ses 1 instrumental data together
S1<-rowMeans(select(data, "1_song2","1_song3")) #ses 1 spoken data together
W1<-rowMeans(select(data, "1_song4",'1_song5'))  #ses 1 whole data together
## Gather all session 2 data
A2<-rowMeans(select(data, "2_song1","2_song8")) #ses 1 acapella data together
I2<-rowMeans(select(data, "2_song6","2_song7")) #ses 1 instrumental data together
S2<-rowMeans(select(data, "2_song2","2_song3")) #ses 1 spoken data together
W2<-rowMeans(select(data, "2_song4",'2_song5'))  #ses 1 whole data together
## Gather all data ignoring sessions
A<-rowMeans(select(data, "1_song1","1_song8","2_song1","2_song8"))
I<-rowMeans(select(data, "1_song6","1_song7","2_song6","2_song7"))
S<-rowMeans(select(data, "1_song2","1_song3","2_song2","2_song3"))
W<-rowMeans(select(data, "1_song4","1_song5","2_song4","2_song5"))
## OTHER STUFF
l=dim(meansync2)[1]
ses<-c(rep(1,l),rep(2,l))
stim<-c(rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4),rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4))
<<<<<<< HEAD
# #plot
# with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1,main="main effect of session"))
#
=======
<<<<<<< HEAD
print("Session 1 ANOVA")
meansync1<-data.frame(A1,I1,S1,W1)
meansync1<-meansync1 %>% gather(type, corr) #rearrange data
fit<-aov(corr~type,data=meansync1)
print(summary(fit))
print("Session 2 ANOVA")
meansync2<-data.frame(A2,I2,S2,W2)
meansync2<-meansync2 %>% gather(type, corr) #rearrange data
fit<-aov(corr~type,data=meansync2)
print(summary(fit))
print("Session 1&2 ANOVA - TYPE 1 - DATA AVERAGED FIRST")
meansyncALL<-data.frame(A,I,S,W)
meansyncALL<-meansyncALL %>% gather(type, corr) #rearrange data
fit<-aov(corr~type,data=meansyncALL)
print(summary(fit))
p1<-ggplot(meansyncALL) + aes(x=type,y=corr) + geom_boxplot() +
ylim(-0.3,0.3) + ggtitle('Data Averaged First - sig')
print("Session 1&2 ANOVA - TYPE 2 - DATA NOT AVERAGED FIRST")
meansyncALL2<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
meansyncALL2<-meansyncALL2 %>% gather(type, corr) #rearrange data
meansyncALL2$stim<-stim
fit<-aov(corr~stim,data=meansyncALL2)
print(summary(fit))
p2<-ggplot(meansyncALL2) + aes(x=as.factor(stim),y=corr) + geom_boxplot() +
ylim(-0.3,0.3) + ggtitle('Data NOT Averaged First - not sig')
=======
## Stats
>>>>>>> 85c138c9b70f19126c222b60092362713f32f37e
#2x4 ANOVA
print("ANOVA - 2(ses) x 4(stim)")
meansync<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
meansync<-meansync %>% gather(type, corr) #rearrange data
meansync$ses<-ses
meansync$stim<-stim
fit<-aov(corr~stim + ses +stim:ses,data=meansync)
<<<<<<< HEAD
meansync$ses<-ses
ses<-c(rep(1,l),rep(2,l))
stim<-c(rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4),rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4))
## OTHER STUFF
l=dim(meansync2)[1]
ses<-c(rep(1,l),rep(2,l))
stim<-c(rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4),rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4))
meansync$ses<-ses
meansync$stim<-stim
fit<-aov(corr~stim + ses +stim:ses,data=meansync)
print(summary(fit))
fit<-aov(corr~stim,data=meansyncALL2)
print(summary(fit))
# plot means
grid.arrange(p1, p2, nrow = 1)
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1))
# plot means
grid.arrange(p1, p2, nrow = 1)
files[66]
=======
print(summary(fit))
#plot
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1,main="main effect of session"))
>>>>>>> e2c8c9011f89314d74ddf205ff7def0214dc038f
p<-ggplot(meansync) +
aes(x=type,y=corr) +
geom_boxplot(color=c("red","blue","green","black","red","blue","green","black")) +
geom_hline(yintercept=0,size=1)+
facet_wrap(~ses)
plot(p)
<<<<<<< HEAD
p1<-ggplot(meansyncALL) + aes(x=type,y=corr) + geom_boxplot() +
ylim(-0.3,0.3) + ggtitle('Data Averaged First - sig')
plot(p1)
=======
>>>>>>> 85c138c9b70f19126c222b60092362713f32f37e
meansyncALL<-data.frame(A,I,S,W)
meansyncALL<-meansyncALL %>% gather(type, corr) #rearrange data
fit<-aov(corr~type,data=meansyncALL)
print(summary(fit))
p1<-ggplot(meansyncALL) + aes(x=type,y=corr) + geom_boxplot() +
ylim(-0.3,0.3) + ggtitle('Data Averaged First - sig')
<<<<<<< HEAD
meansyncALL2<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
meansyncALL2<-meansyncALL2 %>% gather(type, corr) #rearrange data
meansyncALL2$stim<-stim
fit<-aov(corr~stim,data=meansyncALL2)
print(summary(fit))
p2<-ggplot(meansyncALL2) + aes(x=as.factor(stim),y=corr) + geom_boxplot() +
ylim(-0.3,0.3) + ggtitle('Data NOT Averaged First - not sig')
=======
print(p)
p1
p1<-ggplot(meansyncALL) + aes(x=type,y=corr) + geom_boxplot() +
ylim(-0.3,0.3) + ggtitle('Data Averaged First - sig')
plot(p1)
>>>>>>> 85c138c9b70f19126c222b60092362713f32f37e
meansync<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
meansync<-meansync %>% gather(type, corr) #rearrange data
meansync$ses<-ses
meansync$stim<-stim
<<<<<<< HEAD
fit<-aov(corr~stim + ses +stim:ses,data=meansync)
print(summary(fit))
# plot means
grid.arrange(p1, p2, nrow = 1)
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1))
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1,main="title"))
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1,main="main effect"))
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1,main="main effect of session"))
# plot means
grid.arrange(p1, p2, nrow = 1)
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1,main="main effect of session"))
#CBSdata<-readr::read_csv("/Users/asternin/Documents/PhDProject/Music and Memory/BehaviouralResults/CBSScoresForISC.csv")
CBSdata<-readr::read_csv("/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/BehaviouralResults/CBSScoresForISC.csv")
View(CBSdata)
View(CBSdata)
# 2x4 ANOVA with LyrOr Covariate
LyrOrdata<-readr::read_csv("/Users/asternin/Documents/PhDProject/Music and Memory/BehaviouralResults/LyrOrScores.csv")
# 2x4 ANOVA with LyrOr Covariate
#LyrOrdata<-readr::read_csv("/Users/asternin/Documents/PhDProject/Music and Memory/BehaviouralResults/LyrOrScores.csv")
LyrOrdata<-readr::read_csv("/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/BehaviouralResults/LyrOrScores.csv")
View(LyrOrdata)
meansync$lyror<-LyrOrdata$LyrOr
View(meansync)
mod.full <- lm(corr~LyrOr + stim*ses)
mod.full <- lm(corr~LyrOr + stim*ses, data=meansync)
mod.full <- lm(corr~lyror
+ stim*ses, data=meansync)
mod.rest <- lm(corr~lyror ,data=meansync)
a2 <- anova(mod.full, mod.rest)
print(a2)
a3 <- anova(mod.full)
print(a3)
#fit<-aov(corr~stim + ses +stim:ses,data=meansync)
fit<-aov(corr~stim*ses,data=meansync)
print(summary(fit))
filse
files
files[8]
f<-8
data<-read.csv(fullfiles[f], header=FALSE) #load data
data<-rename(data,c("V1"="1_song1", "V2"="1_song2", "V3"="1_song3", "V4"="1_song4",
"V5"="1_song5", "V6"="1_song6", "V7"="1_song7", "V8"="1_song8",
"V9"="2_song1", "V10"="2_song2", "V11"="2_song3", "V12"="2_song4",
"V13"="2_song5", "V14"="2_song6", "V15"="2_song7", "V16"="2_song8"))
GroupAdata<-data[c(1,3,5,7,10,12,13,14,16,18),c(1:16)]
GroupBdata<-data[c(2,4,6,8,9,11,15,17,19),c(1:16)]
##### RUN ALL STATS #####
## Gather all session 1 data
A1<-rowMeans(select(data, "1_song1","1_song8")) #ses 1 acapella data together
I1<-rowMeans(select(data, "1_song6","1_song7")) #ses 1 instrumental data together
S1<-rowMeans(select(data, "1_song2","1_song3")) #ses 1 spoken data together
W1<-rowMeans(select(data, "1_song4",'1_song5'))  #ses 1 whole data together
meansync1<-data.frame(A1,I1,S1,W1)
meansync1<-meansync1 %>% gather(type, corr) #rearrange data
## Gather all session 2 data
A2<-rowMeans(select(data, "2_song1","2_song8")) #ses 1 acapella data together
I2<-rowMeans(select(data, "2_song6","2_song7")) #ses 1 instrumental data together
S2<-rowMeans(select(data, "2_song2","2_song3")) #ses 1 spoken data together
W2<-rowMeans(select(data, "2_song4",'2_song5'))  #ses 1 whole data together
meansync2<-data.frame(A2,I2,S2,W2)
meansync2<-meansync2 %>% gather(type, corr) #rearrange data
meansync<-data.frame(A1,I1,S1,W1,A2,I2,S2,W2)
meansync<-meansync %>% gather(type, corr) #rearrange data
## Gather all data across sessions together
A<-rowMeans(select(data, "1_song1","1_song8","2_song1","2_song8"))
I<-rowMeans(select(data, "1_song6","1_song7","2_song6","2_song7"))
S<-rowMeans(select(data, "1_song2","1_song3","2_song2","2_song3"))
W<-rowMeans(select(data, "1_song4","1_song5","2_song4","2_song5"))
meansyncALL<-data.frame(A,I,S,W)
meansyncALL<-meansyncALL %>% gather(type, corr) #rearrange data
sprintf("%s.txt",str_replace(files[f],".csv",""))
l=dim(meansync2)[1]
ses<-c(rep(1,l),rep(2,l))
stim<-c(rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4),rep(1,l/4),rep(2,l/4),rep(3,l/4),rep(4,l/4))
meansync$ses<-ses
meansync$stim<-stim
#fit<-aov(corr~stim + ses +stim:ses,data=meansync)
fit<-aov(corr~stim*ses,data=meansync)
print(summary(fit))
# 2x4 ANOVA with LyrOr Covariate
#LyrOrdata<-readr::read_csv("/Users/asternin/Documents/PhDProject/Music and Memory/BehaviouralResults/LyrOrScores.csv")
LyrOrdata<-readr::read_csv("/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/BehaviouralResults/LyrOrScores.csv")
=======
fit1<-aov(corr~stim + ses +stim:ses,data=meansync)
print(summary(fit1))
#plot
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1,main="main effect of session"))
p<-ggplot(meansync) +
aes(x=type,y=corr) +
geom_boxplot(color=c("red","blue","green","black","red","blue","green","black")) +
geom_hline(yintercept=0,size=1) +
ylim(-0.4,0.4)+
facet_wrap(~ses)
plot(p)
p<-ggplot(meansync) +
aes(x=type,y=corr) +
geom_boxplot(color=c("red","blue","green","black","red","blue","green","black")) +
geom_hline(yintercept=0,size=1)
facet_wrap(~ses)
plot(p)
p<-ggplot(meansync) +
aes(x=type,y=corr) +
geom_boxplot(color=c("red","blue","green","black","red","blue","green","black")) +
geom_hline(yintercept=0,size=1)+
facet_wrap(~ses)
plot(p)
print(summary(fit1))
#plot
with(meansync, interaction.plot(ses,stim,corr,col=1:4,lty=1,main="main effect of session"))
# 2x4 ANOVA with LyrOr Covariate
#LyrOrdata<-readr::read_csv("/Users/asternin/Documents/PhDProject/Music and Memory/BehaviouralResults/LyrOrScores.csv")
LyrOrdata<-readr::read_csv("/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/BehaviouralResults/LyrOrScores.csv")
meansync$lyror<-LyrOrdata$LyrOr
# 2x4 ANOVA with LyrOr Covariate
LyrOrdata<-readr::read_csv("/Users/asternin/Documents/PhDProject/Music and Memory/BehaviouralResults/LyrOrScores.csv")
#LyrOrdata<-readr::read_csv("/Users/avitalsternin/Documents/Western/Academics/PhDProject.git/Music and Memory/BehaviouralResults/LyrOrScores.csv")
>>>>>>> 85c138c9b70f19126c222b60092362713f32f37e
meansync$lyror<-LyrOrdata$LyrOr
mod.full <- lm(corr~lyror + stim*ses, data=meansync)
mod.rest <- lm(corr~lyror ,data=meansync)
a2 <- anova(mod.full, mod.rest)
print(a2)
a3 <- anova(mod.full)
print(a3)
<<<<<<< HEAD
View(meansyncALL)
View(meansyncALL2)
152/2
=======
anova(mod.rest)
>>>>>>> 85c138c9b70f19126c222b60092362713f32f37e
>>>>>>> e2c8c9011f89314d74ddf205ff7def0214dc038f
